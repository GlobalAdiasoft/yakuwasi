 $(document).ready(function() {
     //desde aqui
     //hasta aqui
     $(".fechas_ui").datepicker({ dateFormat: 'yy-mm-dd' });
     totales_gastos();
     totales('total_contado', 'contado');
     totales('total_debit', 'Visa-Debit');
     totales('total_credi', 'Visa-Credi');
     totales('total_all', 'all');
     $(".fechas_ui").change(function() {
         table_contado.ajax.reload();
         table_all.ajax.reload();
         table_debit.ajax.reload();
         table_credi.ajax.reload();
         table_gastos.ajax.reload();
         totales_gastos();
         totales('total_contado', 'contado');
         totales('total_debit', 'Visa-Debit');
         totales('total_credi', 'Visa-Credi');
         totales('total_all', 'all');
         ajax_data();
     })
     var table_contado = $('#table_contado').DataTable({
         "ajax": {
             "url": '../VentasEfrain/reporte/contado',
             "dataSrc": "",
             "data": function(d) {
                 d.fecha_inicio = $('input[name=fecha_inicio]').val();
                 d.fecha_final = $('input[name=fecha_final').val();
             },
         },
         "columns": [{
             "data": "id_venta"
         }, {
             "data": "fecha_hora"
         }, {
             "data": "mesa"
         }, {
             "data": "total_bruto"
         }, {
             "data": "hecho_por"
         }, {
             "data": "num_boleta"
         }],
         dom: '<"row"<"col-12 col-sm-12 col-md-6"l><"col-12 col-sm-12 col-md-6">>rt<"top"B><"col-12">p',
     });
     var table_all = $('#table_all').DataTable({
         "ajax": {
             "url": '../VentasEfrain/reporte/all',
             "dataSrc": "",
             "data": function(d) {
                 d.fecha_inicio = $('input[name=fecha_inicio]').val();
                 d.fecha_final = $('input[name=fecha_final').val();
             },
         },
         "columns": [{
             "data": "id_venta"
         }, {
             "data": "fecha_hora"
         }, {
             "data": "mesa"
         }, {
             "data": "total_bruto"
         }, {
             "data": "hecho_por"
         }, {
             "data": "num_boleta"
         }],
         dom: '<"row"<"col-12 col-sm-12 col-md-6"l><"col-12 col-sm-12 col-md-6">>rt<"top"B><"col-12">p',
     });
     var table_debit = $('#table_debit').DataTable({
         "ajax": {
             "url": '../VentasEfrain/reporte/Visa-Debit',
             "dataSrc": "",
             "data": function(d) {
                 d.fecha_inicio = $('input[name=fecha_inicio]').val();
                 d.fecha_final = $('input[name=fecha_final').val();
             },
         },
         "columns": [{
             "data": "id_venta"
         }, {
             "data": "fecha_hora"
         }, {
             "data": "mesa"
         }, {
             "data": "total_bruto"
         }, {
             "data": "hecho_por"
         }, {
             "data": "num_boleta"
         }],
         dom: '<"row"<"col-12 col-sm-12 col-md-6"l><"col-12 col-sm-12 col-md-6">>rt<"top"B><"col-12">p',
     });
     var table_credi = $('#table_credi').DataTable({
         "ajax": {
             "url": '../VentasEfrain/reporte/Visa-Credi',
             "dataSrc": "",
             "data": function(d) {
                 d.fecha_inicio = $('input[name=fecha_inicio]').val();
                 d.fecha_final = $('input[name=fecha_final').val();
             },
         },
         "columns": [{
             "data": "id_venta"
         }, {
             "data": "fecha_hora"
         }, {
             "data": "mesa"
         }, {
             "data": "total_bruto"
         }, {
             "data": "hecho_por"
         }, {
             "data": "num_boleta"
         }],
         dom: '<"row"<"col-12 col-sm-12 col-md-6"l><"col-12 col-sm-12 col-md-6">>rt<"top"B><"col-12">p',
     });
     var table_gastos = $('#table_gastos').DataTable({
         "ajax": {
             "url": '../VentasEfrain/reporte_gastos',
             "dataSrc": "",
             "data": function(d) {
                 d.fecha_inicio = $('input[name=fecha_inicio]').val();
                 d.fecha_final = $('input[name=fecha_final').val();
             },
         },
         "columns": [{
             "data": "id"
         }, {
             "data": "fecha_hora"
         }, {
             "data": "mesa"
         }, {
             "data": "total_bruto"
         }, ],
         dom: '<"row"<"col-12 col-sm-12 col-md-6"l><"col-12 col-sm-12 col-md-6">>rt<"top"B><"col-12">p',
     });
 });

 function totales(variable, busqueda) {
     var fecha_inicio = $('input[name=fecha_inicio]').val();
     var fecha_final = $('input[name=fecha_final]').val();
     $.ajax({
         url: '../VentasEfrain/total/' + busqueda,
         type: "post",
         dataType: "json",
         data: {
             'fecha_inicio': fecha_inicio,
             'fecha_final': fecha_final,
         },
         success: function(data) {
             $('.' + variable).html(data.total);
             $('input[name=' + variable + ']').val(data.total_s.toFixed(2));
             $('.reporte_total_ingreso').html($('.total_all').html());
             $('.reporte_total_egreso').html($('.total_gastos').html());
             $('.reporte2_total_contado').html($('.total_contado').html());
             $('.reporte2_total_egreso').html($('.total_gastos').html());
             var r_t_i = $('input[name=total_all]').val();
             var r_t_e = $('input[name=total_gastos]').val();
             var r_t_c = $('input[name=total_contado]').val();
             $('.reporte_total_utilidad').html((r_t_i - r_t_e).toFixed(2));
             $('.reporte2_total_utilidad').html((r_t_c - r_t_e).toFixed(2));
             convertir_moneda($('.reporte_total_utilidad').html());
             convertir_moneda2($('.reporte2_total_utilidad').html());
         }
     });
 }

 function totales_gastos() {
     var fecha_inicio = $('input[name=fecha_inicio]').val();
     var fecha_final = $('input[name=fecha_final]').val();
     $.ajax({
         url: '../VentasEfrain/total_gastos/',
         type: "post",
         dataType: "json",
         data: {
             'fecha_inicio': fecha_inicio,
             'fecha_final': fecha_final,
         },
         success: function(data) {
             $('.total_gastos').html(data.total);
             $('input[name=total_gastos]').val(data.total_s.toFixed(2));
         }
     });
 }

 function convertir_moneda(data) {
     $.ajax({
         url: '../VentasEfrain/convertir_moneda/' + data,
         type: "post",
         dataType: "json",
         success: function(data) {
             $('.reporte_total_utilidad').html(data.total);
         }
     });
 }

 function convertir_moneda2(data) {
     $.ajax({
         url: '../VentasEfrain/convertir_moneda/' + data,
         type: "post",
         dataType: "json",
         success: function(data) {
             $('.reporte2_total_utilidad').html(data.total);
         }
     });
 }

 function ajax_data() {
     var fecha_inicio = $('input[name=fecha_inicio]').val();
     var fecha_final = $('input[name=fecha_final]').val();
     $.ajax({
         type: 'GET',
         url: '../VentasEfrain/totales_fechas/',
         dataType: "json",
         data: {
             'fecha_inicio': fecha_inicio,
             'fecha_final': fecha_final,
         },
         cache: false,
         timeout: 20000,
         beforeSend: function(data) {},
         success: function(data) {
             charts(data);
         },
         error: function(data) {
             alert("Error In Connecting");
         }
     });
 }

 function charts(data) {
     var jsonData = data;
     google.load("visualization", "1", { packages: ["corechart"], callback: drawVisualization });

     function drawVisualization() {
         var data = new google.visualization.DataTable();
         data.addColumn('string', 'Fecha');
         data.addColumn('number', 'Reporte Ventas');
         data.addColumn('number', 'Reportes Gastos');
         data.addColumn('number', 'Utilidad');
         $.each(jsonData, function(i, jsonData) {
             var fecha = jsonData.fecha;
             var total_ingresos = jsonData.total_ingresos;
             var total_egresos = jsonData.total_egresos;
             var utilidad = jsonData.utilidad;
             data.addRows([
                 [fecha, total_ingresos, total_egresos, utilidad]
             ]);
         });
         var options = {
             title: "Fechas",
             animation: {
                 duration: 3000,
                 easing: 'out',
                 startup: true
             },
             colorAxis: { colors: ['#54C492', '#cc0000'] },
             datalessRegionColor: '#00FF00',
             defaultColor: '#dedede',
             series: {
                 0: { color: '#1493B6' },
                 1: { color: '#073441' },
             }
         };
         var chart;
         chart = new google.visualization.LineChart(document.getElementById('container'));
         chart.draw(data, options);
     }
 }