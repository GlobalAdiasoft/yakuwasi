$(document).ready(function(){var a=$(".datatable").DataTable({ajax:{url:"../Verfacturas/mostrarfacturas",dataSrc:""},columns:[{data:"id"},{data:"fac_correlativo"},{data:"fac_numero_factura"},{data:"btn_generarfacturasunat"},{data:"fact_pdf"},{data:"fact_xml"},{data:"fact_cdr"},{data:"descripcion"},{data:"btn_imprimirguia"},],order:[[2,"desc"]]});
$(".datatable tbody").on("click","#btn_eliminar",function(){var b=a.row($(this).parents("tr")).data();eliminar_factura(b.fac_correlativo,b.fac_numero_factura);
});$(".datatable tbody").on("click","#btn_imprimirfactura",function(){var b=a.row($(this).parents("tr")).data();imprimir_factura(b.fac_correlativo,b.fac_numero_factura);
});$(".datatable tbody").on("click","#btn_generarfacturasunat",function(){var b=a.row($(this).parents("tr")).data();generarfacturasunat(b.fac_correlativo,b.fac_numero_factura);
});$(".datatable tbody").on("click","#btn_imprimirguia",function(){var b=a.row($(this).parents("tr")).data();imprimir_guia(b.fac_correlativo,b.fac_numero_factura,b.id);
});$(".datatable tbody").on("click","#btn_volvera_generarfacturasunat",function(){var b=a.row($(this).parents("tr")).data();volvera_generarfacturasunat(b.fac_correlativo,b.fac_numero_factura);
});$(".datatable tbody").on("click","#btn_anular",function(){var b=a.row($(this).parents("tr")).data();anular_factura(b.fac_correlativo,b.fac_numero_factura);
});$(".datatable tbody").on("click","#btn_actualizar_factura",function(){var b=a.row($(this).parents("tr")).data();actualizar_factura(b.fac_correlativo,b.fac_numero_factura);
});$(".datatable tbody").on("click","#btn_actualizar_anulacion",function(){var b=a.row($(this).parents("tr")).data();actualizar_anulacion(b.fac_correlativo,b.fac_numero_factura);
});});function eliminar_factura(a,b){$.ajax({url:"../Verfacturas/eliminar_factura",type:"POST",dataType:"html",data:{fac_numero_factura:b,fac_correlativo:a,},success:function(c){table=$(".datatable").DataTable();
table.ajax.reload();}});}function imprimir_factura(a,b){window.open("../Facturas/imprimirfactura?fac_correlativo="+a+"&fac_numero_factura="+b,"_blank");
}function imprimir_guia(a,c,b){window.open("../Facturas/imprimirguia?fac_correlativo="+a+"&fac_numero_factura="+c+"&id="+b,"_blank");}function generarfacturasunat(a,b){cambiar_envio_sunat(a,b);
window.open("../Facturas/pruebas/"+a+"/"+b,"_blank");}function volvera_generarfacturasunat(a,b){window.open("../Facturas/consultar_comprobante/"+a+"/"+b,"_blank");
}function cambiar_envio_sunat(a,b){$.ajax({url:"../Facturas/cambiar_envio_sunat",type:"POST",dataType:"html",data:{fac_numero_factura:b,fac_correlativo:a,},success:function(c){table=$(".datatable").DataTable();
table.ajax.reload();}});}function anular_factura(b,a){$.ajax({url:"../Facturar/anular_factura/"+b+"/"+a,type:"POST",dataType:"html",beforeSend:function(){alertify.notify(' <img class="loading" src="../public/img/spinner.svg"> Anulando <img class="alertify-sunat" src="../public/img/sunat.png" alt="">',"custom-black",3600,function(){});
},success:function(c){alertify.dismissAll();alertify.notify("<strong>Factura </strong> Anulaci√≥n enviada","custom-black",1,function(){});table=$(".datatable").DataTable();
table.ajax.reload();}});}function actualizar_factura(b,a){$.ajax({url:"../Facturar/consultar_factura/"+b+"/"+a,type:"POST",dataType:"html",beforeSend:function(){alertify.notify(' <img class="loading" src="../public/img/spinner.svg"> Actualizando con <img class="alertify-sunat" src="../public/img/sunat.png" alt="">',"custom-black",3600,function(){});
},success:function(c){alertify.dismissAll();alertify.notify("<strong>Factura</strong> Actualizado correctamente","custom-black",1,function(){});table=$(".datatable").DataTable();
table.ajax.reload();}});}function actualizar_anulacion(b,a){$.ajax({url:"../Facturar/consultar_anulacion/"+b+"/"+a,type:"POST",dataType:"html",beforeSend:function(){alertify.notify(' <img class="loading" src="../public/img/spinner.svg"> Actualizando con <img class="alertify-sunat" src="../public/img/sunat.png" alt="">',"custom-black",3600,function(){});
},success:function(c){console.log(c);alertify.dismissAll();alertify.notify("<strong>Factura</strong> Actualizado correctamente","custom-black",1,function(){});
table=$(".datatable").DataTable();table.ajax.reload();}});}